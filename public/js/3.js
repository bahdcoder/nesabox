(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{ls82:function(e,t,r){var o=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},n=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",i=o.toStringTag||"@@toStringTag";function s(e,t,r,o){var n=t&&t.prototype instanceof u?t:u,a=Object.create(n.prototype),i=new x(o||[]);return a._invoke=function(e,t,r){var o="suspendedStart";return function(n,a){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===n)throw a;return k()}for(r.method=n,r.arg=a;;){var i=r.delegate;if(i){var s=b(i,r);if(s){if(s===c)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===o)throw o="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o="executing";var u=l(e,t,r);if("normal"===u.type){if(o=r.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o="completed",r.method="throw",r.arg=u.arg)}}}(e,r,i),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var c={};function u(){}function d(){}function f(){}var v={};v[n]=function(){return this};var m=Object.getPrototypeOf,p=m&&m(m(C([])));p&&p!==t&&r.call(p,n)&&(v=p);var h=f.prototype=u.prototype=Object.create(v);function y(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function g(e,t){var o;this._invoke=function(n,a){function i(){return new t((function(o,i){!function o(n,a,i,s){var c=l(e[n],e,a);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,s)}),(function(e){o("throw",e,i,s)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,s)}))}s(c.arg)}(n,a,o,i)}))}return o=o?o.then(i,i):i()}}function b(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var o=l(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,c;var n=o.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function C(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(r.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:k}}function k(){return{value:void 0,done:!0}}return d.prototype=h.constructor=f,f.constructor=d,f[i]=d.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,i in e||(e[i]="GeneratorFunction")),e.prototype=Object.create(h),e},e.awrap=function(e){return{__await:e}},y(g.prototype),g.prototype[a]=function(){return this},e.AsyncIterator=g,e.async=function(t,r,o,n,a){void 0===a&&(a=Promise);var i=new g(s(t,r,o,n),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(h),h[i]="Generator",h[n]=function(){return this},h.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var o=t.pop();if(o in e)return r.value=o,r.done=!1,r}return r.done=!0,r}},e.values=C,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(r,o){return i.type="throw",i.arg=e,t.next=r,o&&(t.method="next",t.arg=void 0),!!o}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],i=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,c):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var o=r.completion;if("throw"===o.type){var n=o.arg;_(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:C(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=o}catch(e){Function("r","regeneratorRuntime = r")(o)}},o0o1:function(e,t,r){e.exports=r("ls82")},q28y:function(e,t,r){"use strict";r.r(t);var o=r("o0o1"),n=r.n(o);function a(e,t,r,o,n,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(o,n)}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var u={data:function(){return{errors:{},loading:!1,created:!1,deployCommand:"",databases:[{label:"Mongo DB v4.2",value:"mongodb"},{label:"MySQL v5.7",value:"mysql"},{label:"MySQL v8.0",value:"mysql8"},{label:"MariaDB v10.13",value:"mariadb"},{label:"Postgresql v11",value:"postgresql"}],regionsAndSizes:{"digital-ocean":[],linode:[],vultr:[]},serverTypes:[{label:"Default",value:"default"},{label:"Load balancer",value:"load_balancer"}],providers:[{icon:"digital-ocean",name:"Digital Ocean"},{icon:"linode",name:"Linode"},{icon:"vultr",name:"Vultr"},{icon:"custom",width:60,height:60,name:"Custom Provider"}],form:{name:"",provider:"",credential_id:"",databases:[]}}},computed:{regions:function(){return this.form.provider?"custom"===this.form.provider?[]:this.regionsAndSizes[this.form.provider].regions:[]},sizes:function(){return this.form.provider?"custom"===this.form.provider?[]:this.regionsAndSizes[this.form.provider].sizes:[]},credentials:function(){return this.form.provider?"custom"===this.form.provider?[]:(this.$root.auth.providers[this.form.provider]||[]).map((function(e){return{label:e.profileName,value:e.id}})):[]},showServerName:function(){return!!this.form.provider&&(!("custom"!==this.form.provider&&!this.form.credential_id)&&(this.form.provider,!0))}},methods:{create:function(){var e=this;this.loading=!0,axios.post("/api/servers",this.form).then((function(t){var r=t.data;"custom"===e.form.provider?(e.created=!0,e.deployCommand=r.deploy_command):e.$router.push("/dashboard")})).catch((function(t){var r=t.response;422===r.status&&(e.errors=r.data.errors),e.$root.flashMessage(r.data.message||"custom"!==e.provider?"Failed to create your server. Please check your provider to make sure you can create servers. Also, check to see if your API token credentials are still valid.":"Failed to create server.","error",8e3)})).finally((function(){e.loading=!1}))},setProvider:function(e){this.form.provider=e.icon,this.form.credential_id=""},selectDatabase:function(e){var t=["mysql","mysql8","mariadb"],r=l(this.form.databases);r.includes(e.value)?r=r.filter((function(t){return t!==e.value})):(t.includes(e.value)&&(r=r.filter((function(e){return!t.includes(e)}))),r=[].concat(l(r),[e.value])),this.form=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},this.form,{databases:r})},copyCommand:function(){var e=document.getElementById("command");e.select(),e.setSelectionRange(0,99999),document.execCommand("copy")}},mounted:function(){var e,t=this;return(e=n.a.mark((function e(){var r,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.get("/api/servers/regions");case 2:r=e.sent,o=r.data,t.regionsAndSizes=o;case 5:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function s(e){a(i,o,n,s,l,"next",e)}function l(e){a(i,o,n,s,l,"throw",e)}s(void 0)}))})()}},d=r("KHd+"),f=Object(d.a)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("layout",[e.created?e._e():r("div",[r("h2",{staticClass:"mb-4 font-semibold text-2xl"},[e._v("Create server")]),e._v(" "),r("form",{staticClass:"w-full",attrs:{method:"POST"},on:{submit:function(t){return t.preventDefault(),e.create(t)}}},[r("div",{staticClass:"shadow sm:rounded-md sm:overflow-hidden"},[r("div",{staticClass:"px-4 md:px-12 py-5 md:py-12 bg-white sm:p-6"},[r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block w-full font-semibold"},[e._v("Server provider")]),e._v(" "),r("small",{staticClass:"text-gray-600 inline-block"},[e._v("Select your server provider. Nesabox will\n                            connect using your provider's API and provision\n                            a server with the specs you select. If you have\n                            already provisioned a server on any provider,\n                            select custom provider. Nesabox will connect to\n                            your already provisioned server.\n                        ")])]),e._v(" "),r("div",{staticClass:"grid grid-cols-1 md:grid-cols-4 gap-4"},e._l(e.providers,(function(t){return r("div",{key:t.icon,staticClass:"py-8 rounded-sm flex items-center flex-col justify-center w-full cursor-pointer border-gray-300 hover:border-sha-green-500",class:{"border-2 border-sha-green-500":e.form.provider===t.icon,"border opacity-50":e.form.provider!==t.icon},on:{click:function(r){return e.setProvider(t)}}},[r("v-svg",{attrs:{icon:t.icon,width:t.width,height:t.height}}),e._v(" "),r("p",{staticClass:"mt-3"},[e._v("\n                                "+e._s(t.name)+"\n                            ")])],1)})),0),e._v(" "),e.form.provider?r("hr",{staticClass:"my-6 md:my-12"}):e._e(),e._v(" "),e.form.provider&&"custom"!==e.form.provider?r("div",{staticClass:"w-full mt-5"},[r("select-input",{attrs:{name:"credential",options:e.credentials,label:"Provider Credential"},model:{value:e.form.credential_id,callback:function(t){e.$set(e.form,"credential_id",t)},expression:"form.credential_id"}},[r("template",{slot:"help"},[r("small",{staticClass:"text-gray-600"},[e._v("\n                                    Select the "+e._s(e.form.provider)+" api key\n                                    to be used to create this server.\n                                    "),0===e.credentials.length?r("span",[e._v("\n                                        You do not have any\n                                        "+e._s(e.form.provider)+" credentials yet.\n                                        "),r("router-link",{staticClass:"rounded text-white bg-sha-green-500 p-1 text-xs px-2",attrs:{to:"/account/server-providers"}},[e._v("Add one here")])],1):e._e()])])],2)],1):e._e(),e._v(" "),e.showServerName?r("div",{staticClass:"w-full mt-8"},[r("text-input",{attrs:{name:"name",label:"Server name",errors:e.errors.name,placeholder:"exasperant-sand-dunes-093",help:"Choose a memorable name that helps you easily find this server. This could be the name of your project."},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1):e._e(),e._v(" "),e.showServerName?r("div",{staticClass:"w-full mt-8"},[r("select-input",{attrs:{name:"type",label:"Server type",errors:e.errors.type,options:e.serverTypes,help:"The default installs everything you need to run sites on a server. The load balancer provisions only nginx, optimizes it for load balancing, with no additional software."},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1):e._e(),e._v(" "),e.showServerName&&"custom"!==e.form.provider?r("div",{staticClass:"w-full mt-8"},[r("select-input",{attrs:{name:"region",label:"Region",options:e.regions,errors:e.errors.region,help:"Select the region / data center where this server should be provisioned. If you are horizontally scaling, make sure you select the same region for all your resources."},model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}})],1):e._e(),e._v(" "),e.showServerName&&"custom"!==e.form.provider?r("div",{staticClass:"w-full mt-8"},[r("select-input",{attrs:{name:"size",label:"Size",options:e.sizes,errors:e.errors.size,help:"Select the size of this server. RAM, GB and vCPUs."},model:{value:e.form.size,callback:function(t){e.$set(e.form,"size",t)},expression:"form.size"}})],1):e._e(),e._v(" "),e.showServerName&&"custom"===e.form.provider?r("div",{staticClass:"w-full mt-8"},[r("text-input",{attrs:{name:"size",label:"Size",type:"number",placeholder:"4",errors:e.errors.size,help:"Provide the RAM of your server in GB. It'll be used to set the SWAP size."},model:{value:e.form.size,callback:function(t){e.$set(e.form,"size",t)},expression:"form.size"}})],1):e._e(),e._v(" "),e.showServerName&&"custom"===e.form.provider?r("div",{staticClass:"w-full mt-8"},[r("text-input",{attrs:{name:"region",label:"Region",errors:e.errors.region,placeholder:"New York 1",help:"Provide the region of your custom server. This can help you identify the location of the server in future."},model:{value:e.form.region,callback:function(t){e.$set(e.form,"region",t)},expression:"form.region"}})],1):e._e(),e._v(" "),e.showServerName&&"custom"===e.form.provider?r("div",{staticClass:"w-full mt-8"},[r("text-input",{attrs:{name:"ip_address",label:"IP Address",placeholder:"196.50.6.1",errors:e.errors.ip_address,help:"Provide the public IPv4 address of your custom server. We'll use this so we can connect to your server."},model:{value:e.form.ip_address,callback:function(t){e.$set(e.form,"ip_address",t)},expression:"form.ip_address"}})],1):e._e(),e._v(" "),e.showServerName&&"custom"===e.form.provider?r("div",{staticClass:"w-full mt-8"},[r("text-input",{attrs:{name:"private_ip_address",placeholder:"196.50.6.1",label:"Private IP Address",errors:e.errors.private_ip_address,help:"Provide the private IPv4 address of your custom server. This is optional, and is useful if you are setting up a network of servers."},model:{value:e.form.private_ip_address,callback:function(t){e.$set(e.form,"private_ip_address",t)},expression:"form.private_ip_address"}})],1):e._e(),e._v(" "),e.form.type&&"load_balancer"!==e.form.type?r("hr",{staticClass:"my-6 md:my-12"}):e._e(),e._v(" "),e.form.type&&"load_balancer"!==e.form.type?r("div",{staticClass:"w-full mt-8"},[r("h3",{staticClass:"leading-6 font-semibold text-gray-900"},[e._v("\n                            Databases\n                        ")]),e._v(" "),r("small",{staticClass:"mt-1 text-gray-500"},[e._v("\n                            Check the databases you need installed on this\n                            server.\n                        ")]),e._v(" "),r("div",{staticClass:"mt-4"},[r("fieldset",e._l(e.databases,(function(t){return r("div",{key:t.value,staticClass:"mt-4"},[r("div",{staticClass:"relative flex items-start"},[r("div",{staticClass:"absolute flex items-center h-5"},[r("input",{staticClass:"form-checkbox h-4 w-4 text-sha-green-600 transition duration-150 ease-in-out",attrs:{type:"checkbox",id:t.value},domProps:{checked:e.form.databases.includes(t.value)},on:{change:function(r){return e.selectDatabase(t)}}})]),e._v(" "),r("div",{staticClass:"pl-7 text-sm leading-5"},[r("label",{staticClass:"font-medium text-gray-700",attrs:{for:t.value}},[e._v("\n                                                "+e._s(t.label)+"\n                                            ")])])])])})),0),e._v(" "),r("flash",{staticClass:"my-4"})],1)]):e._e()]),e._v(" "),r("div",{staticClass:"flex flex-wrap flex-wrap-reverse md:block px-4 py-3 bg-gray-50 text-right sm:px-6"},[r("router-link",{staticClass:"w-full md:w-auto inline-flex rounded-md shadow-sm",attrs:{to:"/dashboard"}},[r("button",{staticClass:"w-full py-2 px-4 border border-gray-300 rounded-md text-sm leading-5 font-medium text-gray-700 hover:text-gray-500 focus:outline-none focus:border-blue-300 focus:shadow-outline-blue active:bg-gray-50 active:text-gray-800 transition duration-150 ease-in-out",attrs:{type:"button"}},[e._v("\n                            Cancel\n                        ")])]),e._v(" "),r("span",{staticClass:"mb-3 md:mb-0 w-full md:w-auto inline-flex rounded-md shadow-sm"},[r("v-button",{attrs:{type:"submit",disabled:e.loading,loading:e.loading,label:"Deploy Server"}})],1)],1)])])]),e._v(" "),e.created&&"custom"===e.form.provider?r("div",[r("h2",{staticClass:"mb-4 font-semibold text-2xl"},[e._v("Create server")]),e._v(" "),r("div",{staticClass:"shadow sm:rounded-md sm:overflow-hidden"},[r("div",{staticClass:"p-5 bg-white"},[r("p",{staticClass:"w-full mb-4 text-gray-900"},[e._v("\n                    Almost there! Login to your server as root and run the\n                    following command. This would provision your server so\n                    that it can be managed by us. Once done, your server\n                    will become active on this dashboard.\n                ")]),e._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.deployCommand,expression:"deployCommand"}],staticClass:"w-full bg-gray-100 shadow-sm px-4 py-3 text-xs text-gray-600 border border-gray-200 rounded",attrs:{id:"command",readonly:""},domProps:{value:e.deployCommand},on:{input:function(t){t.target.composing||(e.deployCommand=t.target.value)}}}),e._v(" "),r("v-button",{staticClass:"mt-4",attrs:{label:"Copy command"},on:{click:e.copyCommand}}),e._v(" "),r("v-trans-button",{staticClass:"mt-4",attrs:{label:"Go to dashboard"},on:{click:function(t){return e.$router.push("/dashboard")}}})],1)])]):e._e()])}),[],!1,null,null,null);t.default=f.exports}}]);